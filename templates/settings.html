<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VolatilX - Settings</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/css/volatilx-header.css">
    <link rel="stylesheet" href="/static/css/subscription.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BC00YPJSRJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-BC00YPJSRJ');
    </script>
</head>
<body class="settings-page bg-slate-950 text-slate-100 font-sans antialiased">
    {% from "_header.html" import render_header %}
    {% set header_user_email = user.email if user and user.email else None %}
    {% set member_since = user.created_at.strftime('%B %d, %Y') if user and user.created_at else 'N/A' %}
    {% set auth_label = (user.oauth_provider.title() + ' OAuth') if user and user.oauth_provider else 'Email &amp; Password' %}
    {% set primary_email = user.email if user and user.email else 'N/A' %}
    {% set stripe_customer = user.stripe_customer_id if user and user.stripe_customer_id else 'Pending' %}
    {% set is_verified = user.is_verified if user else False %}
    {% set checkout_state = request.query_params.get('checkout') %}
    {{ render_header(
        page='settings',
        title='Account Settings',
        subtitle='Fine-tune your VolatilX experience, manage subscription tiers, and keep security dialed in.',
        badge='Control Panel',
        user_email=header_user_email
    ) }}

    <main class="relative isolate">
        <div class="pointer-events-none absolute inset-0 -z-10 overflow-hidden">
            <div class="absolute -left-24 top-40 h-96 w-96 rounded-full bg-sky-500/15 blur-3xl"></div>
            <div class="absolute right-10 top-0 h-[28rem] w-[28rem] rounded-full bg-emerald-500/10 blur-3xl"></div>
            <div class="absolute bottom-0 left-1/2 h-80 w-80 -translate-x-1/2 rounded-full bg-indigo-500/10 blur-3xl"></div>
        </div>

        <div class="mx-auto max-w-7xl px-6 pb-20 pt-12 lg:pb-28">
            {% if checkout_state == 'success' %}
                <div class="mb-8 rounded-3xl border border-emerald-500/40 bg-emerald-500/10 px-6 py-5 text-sm font-medium text-emerald-100 shadow-inner shadow-black/30" role="status">
                    Subscription updated. You will receive a confirmation email shortly.
                </div>
            {% elif checkout_state == 'cancel' %}
                <div class="mb-8 rounded-3xl border border-amber-500/40 bg-amber-500/10 px-6 py-5 text-sm font-medium text-amber-100 shadow-inner shadow-black/30" role="status">
                    Checkout canceled. Your existing plan remains active.
                </div>
            {% endif %}

            <div class="grid gap-6 lg:grid-cols-[1.15fr_0.85fr]">
                <section class="rounded-3xl border border-slate-800/60 bg-slate-950/70 p-8 shadow-2xl shadow-black/35">
                    <header class="flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between">
                        <div>
                            <h1 class="text-xl font-semibold text-white">Account Information</h1>
                            <p class="text-sm text-slate-300">Your VolatilX profile snapshot.</p>
                        </div>
                        <span class="inline-flex items-center gap-2 rounded-full border border-emerald-400/40 bg-emerald-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-emerald-100">
                            <span class="h-1.5 w-1.5 rounded-full bg-emerald-300" aria-hidden="true"></span>
                            Active
                        </span>
                    </header>
                    <dl class="mt-6 grid gap-6 text-sm text-slate-200 sm:grid-cols-2">
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Email</dt>
                            <dd class="text-base font-medium text-white">{{ primary_email }}</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Member since</dt>
                            <dd class="text-base font-medium text-white">{{ member_since }}</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Authentication</dt>
                            <dd class="text-base font-medium text-white">{{ auth_label | safe }}</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Stripe customer</dt>
                            <dd class="text-base font-medium text-white">{{ stripe_customer }}</dd>
                        </div>
                    </dl>
                </section>

                <section class="rounded-3xl border border-slate-800/60 bg-slate-950/70 p-8 shadow-2xl shadow-black/35">
                    <header class="flex flex-col gap-2">
                        <h2 class="text-xl font-semibold text-white">Security &amp; Verification</h2>
                        <p class="text-sm text-slate-300">Keep your credentials resilient.</p>
                    </header>
                    <div class="mt-6 space-y-6 text-sm text-slate-200">
                        <div class="flex items-start justify-between gap-6">
                            <div>
                                <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Authentication method</p>
                                <p class="mt-1 text-base font-medium text-white">{{ auth_label | safe }}</p>
                            </div>
                            <span class="inline-flex items-center gap-2 rounded-full border border-sky-500/40 bg-sky-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-sky-100">Secure</span>
                        </div>
                        <div class="flex items-start justify-between gap-6">
                            <div>
                                <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Account verification</p>
                                {% if is_verified %}
                                    <p class="mt-1 text-base font-medium text-emerald-200">Verified</p>
                                    <p class="mt-2 text-xs text-slate-400">Two-factor prompts are delivered to your primary contact method.</p>
                                {% else %}
                                    <p class="mt-1 text-base font-medium text-amber-200">Not Verified</p>
                                    <p class="mt-2 text-xs text-slate-400">Complete verification to unlock automated billing and rapid response support.</p>
                                {% endif %}
                            </div>
                            {% if is_verified %}
                                <span class="inline-flex items-center gap-2 rounded-full border border-emerald-500/40 bg-emerald-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-emerald-100">Ready</span>
                            {% else %}
                                <span class="inline-flex items-center gap-2 rounded-full border border-amber-500/40 bg-amber-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-amber-100">Action needed</span>
                            {% endif %}
                        </div>
                        <div class="rounded-2xl border border-slate-800/70 bg-slate-950/80 px-5 py-4 text-xs text-slate-300">
                            Refresh your API secrets from the developer console whenever you rotate exchange keys. VolatilX invalidates stale secrets instantly to keep your desk insulated.
                        </div>
                    </div>
                </section>
            </div>

            <div class="mt-6 grid gap-6 lg:grid-cols-2">
                <section class="rounded-3xl border border-slate-800/60 bg-slate-950/70 p-8 shadow-xl shadow-black/30">
                    <header class="flex flex-col gap-2">
                        <h2 class="text-lg font-semibold text-white">AI Analysis</h2>
                        <p class="text-sm text-slate-300">Principal-agent orchestration is online.</p>
                    </header>
                    <ul class="mt-6 space-y-3 text-sm text-slate-200">
                        <li class="flex items-start gap-3">
                            <span class="mt-1 h-1.5 w-1.5 rounded-full bg-emerald-400" aria-hidden="true"></span>
                            Market position assessment across preferred instruments.
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="mt-1 h-1.5 w-1.5 rounded-full bg-sky-400" aria-hidden="true"></span>
                            Strategy blends generated by the principal agent and validated by specialists.
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="mt-1 h-1.5 w-1.5 rounded-full bg-amber-400" aria-hidden="true"></span>
                            Risk envelopes updated with every run so you can adjust capital swiftly.
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="mt-1 h-1.5 w-1.5 rounded-full bg-rose-400" aria-hidden="true"></span>
                            Playbook-ready execution notes spanning intraday to weekly horizons.
                        </li>
                    </ul>
                    <div class="mt-6 inline-flex items-center gap-3 rounded-full border border-emerald-500/40 bg-emerald-500/10 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-emerald-100">
                        <span class="h-1.5 w-1.5 rounded-full bg-emerald-300" aria-hidden="true"></span>
                        Ready to deploy
                    </div>
                </section>

                <section class="rounded-3xl border border-slate-800/60 bg-slate-950/70 p-8 shadow-xl shadow-black/30">
                    <header class="flex flex-col gap-2">
                        <h2 class="text-lg font-semibold text-white">Trading Preferences</h2>
                        <p class="text-sm text-slate-300">Current thresholds used by automated diagnostics.</p>
                    </header>
                    <dl class="mt-6 grid gap-5 text-sm text-slate-200 sm:grid-cols-2">
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Buy threshold</dt>
                            <dd class="text-base font-medium text-white">70% confidence</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Sell threshold</dt>
                            <dd class="text-base font-medium text-white">70% confidence</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Analysis mode</dt>
                            <dd class="text-base font-medium text-white">High confidence only</dd>
                        </div>
                        <div class="space-y-1">
                            <dt class="text-xs uppercase tracking-[0.3em] text-slate-400">Timeframes</dt>
                            <dd class="text-base font-medium text-white">1m · 5m · 15m · 30m · 1h · 1d · 1wk</dd>
                        </div>
                    </dl>
                    <p class="mt-6 rounded-2xl border border-slate-800/70 bg-slate-950/80 px-5 py-4 text-xs text-slate-300">
                        Contact support to calibrate thresholds against a custom risk model or to enable experimental agents.
                    </p>
                </section>
            </div>

            <section id="subscriptionSection" class="mt-12 space-y-6 rounded-3xl border border-slate-800/60 bg-slate-950/70 px-8 py-10 shadow-2xl shadow-black/40">
                <header class="flex flex-col gap-3 text-center">
                    <div class="inline-flex items-center gap-2 self-center rounded-full border border-slate-700/60 bg-slate-900/70 px-4 py-1 text-[11px] font-semibold uppercase tracking-[0.4em] text-slate-200/90">
                        <span class="h-1.5 w-1.5 rounded-full bg-sky-400" aria-hidden="true"></span>
                        Billing Console
                    </div>
                    <h2 class="text-3xl font-semibold tracking-tight text-white">Subscription plans engineered for your desk</h2>
                    <p class="mx-auto max-w-3xl text-sm leading-relaxed text-slate-300">
                        Compare allocation, throughput, and concierge access. Swap tiers instantly without losing your analysis history.
                    </p>
                </header>

                <div id="subscriptionRoot" class="min-h-[240px]">
                    <div class="rounded-3xl border border-slate-800/70 bg-slate-950/80 p-10 text-center text-sm text-slate-300 shadow-inner shadow-black/30">
                        Loading billing console…
                    </div>
                </div>
                <noscript>
                    <p class="rounded-3xl border border-rose-500/40 bg-rose-500/10 px-5 py-4 text-center text-sm text-rose-100">
                        Enable JavaScript to manage subscription plans from this console.
                    </p>
                </noscript>
            </section>

            <section class="mt-10 rounded-3xl border border-slate-800/60 bg-slate-950/70 p-8 shadow-xl shadow-black/35">
                <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
                    <div class="max-w-3xl space-y-3">
                        <h3 class="text-lg font-semibold text-white">Need a bespoke rollout?</h3>
                        <p class="text-sm text-slate-300">
                            Our concierge team can stage custom integrations, add team-wide access, and deliver quarterly agent briefings. Use the contact widget to schedule a call within 48 hours.
                        </p>
                    </div>
                    <div class="inline-flex items-center gap-2 self-start rounded-full border border-rose-500/40 bg-rose-500/10 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-rose-100">
                        <span class="h-1.5 w-1.5 rounded-full bg-rose-300" aria-hidden="true"></span>
                        Concierge desk
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script id="subscriptionBootstrap" type="application/json">
        {{ {'currentSubscription': None} | tojson | safe }}
    </script>
    <script type="module" src="{{ asset_url('subscription.js') }}"></script>
    {% include "_contact_widget.html" %}
</body>
</html>